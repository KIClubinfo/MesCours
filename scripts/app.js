
/**
  @ngdoc module
  @name edt-demo
  @module edt-demo
  @description

  This module requires all submodules of your app
 */
'use strict';
angular.module('edt-demo', ['ngMaterial', 'LocalStorageModule', 'edt-demo.utils', 'edt-demo.edt']);


/**
  @ngdoc module
  @name edt-demo.landing
  @module edt-demo.landing
  @description

  Landing page of the application.
 */
angular.module('edt-demo.edt', ['ng', 'ui.router']);


/**
  @ngdoc module
  @name boilerplate.utils
  @module boilerplate.utils
  @description

  This module contains helpers and global configuration required by your app
 */
angular.module('edt-demo.utils', ['ng', 'ui.router']);

angular.module('edt-demo.edt').controller('CourseListCtrl', function($scope, $stateParams, $mdDialog, CourseFactory, DepartmentListExtractor, localStorageService) {
  var alertNoNetwork, setDepartment;
  $scope.currentDepartment = null;
  $scope.currentDate = new Date();
  $scope.errorNoNetwork = false;
  alertNoNetwork = $mdDialog.alert().title('Erreur réseau').content('Impossible de récupérer la liste des cours !').ariaLabel('Network error').ok('Dommage :(');
  $scope.loadCourses = function() {
    return CourseFactory.findAll().success(function(data) {
      $scope.errorNoNetwork = false;
      $scope.courses = data;
      console.log("Found " + $scope.courses.length + " courses");
      $scope.departments = DepartmentListExtractor.extract($scope.courses);
      console.log("Found " + $scope.departments.length + " departments");
      return setDepartment();
    }).error(function() {
      $mdDialog.show(alertNoNetwork);
      return $scope.errorNoNetwork = true;
    });
  };
  $scope.departmentFilter = function(course) {
    return !$scope.currentDepartment || course.department === $scope.currentDepartment;
  };
  $scope.pastCourseFilter = function(course) {
    return !$scope.prefs.hidePastCourses || new Date(Date.parse(course.time_end)) > $scope.currentDate;
  };
  $scope.loadCourses();
  return setDepartment = function() {
    $scope.currentDepartment = $stateParams.dep || localStorageService.get('currentDepartment') || null;
    return $scope.$watch('currentDepartment', function() {
      return localStorageService.set('currentDepartment', $scope.currentDepartment);
    }, true);
  };
});

angular.module('edt-demo.edt').controller('ParametersCtrl', function($scope, $stateParams, $mdDialog, $mdSidenav, localStorageService) {
  var prefs;
  prefs = localStorageService.get('prefs');
  if (prefs) {
    $scope.prefs = prefs;
  } else {
    $scope.prefs = {
      hidePastCourses: true
    };
  }
  $scope.$watch('prefs', function() {
    return localStorageService.set('prefs', $scope.prefs);
  }, true);
  return $scope.toggleSidebar = function() {
    return $mdSidenav('left').toggle();
  };
});

angular.module('edt-demo.edt').factory('CourseFactory', function($rootScope, $http, BASE_API_URL) {
  var findAll, findByDepartment;
  findAll = function(date) {
    var params;
    if (date == null) {
      date = null;
    }
    params = {
      date: date || moment().format('DD/MM/YYYY')
    };
    return $http({
      method: 'GET',
      url: BASE_API_URL + 'courses',
      params: params
    }).success(function(data) {
      return data;
    });
  };
  findByDepartment = function(departmentCode, date) {
    var params;
    if (date == null) {
      date = null;
    }
    params = {
      date: date || moment().format('DD/MM/YYYY'),
      department: departmentCode
    };
    return $http({
      method: 'GET',
      url: BASE_API_URL + 'courses',
      params: params
    }).success(function(data) {
      return data;
    });
  };
  return {
    findAll: findAll,
    findByDepartment: findByDepartment
  };
});

angular.module('edt-demo.edt').service('DepartmentListExtractor', function(localStorageService) {
  var extract;
  extract = function(courses) {
    var course, departments, _i, _len;
    departments = localStorageService.get('departments');
    if (!departments) {
      console.log('Extracting departments...');
      departments = [];
      for (_i = 0, _len = courses.length; _i < _len; _i++) {
        course = courses[_i];
        if (departments.indexOf(course.department) === -1) {
          departments.push(course.department);
        }
      }
      localStorageService.set('departments', departments);
    }
    return departments;
  };
  return {
    extract: extract
  };
});


/**
  @ngdoc object
  @name storage
  @module edt-demo.utils
  @description

  This value object is an application-wide data-store.
  It's published in `$rootScope` for easy-access in views.
 */
angular.module('edt-demo.utils').value('storage', {}).run(function($rootScope, storage) {
  return $rootScope.storage = storage;
});

angular.module('edt-demo.edt').config(function(localStorageServiceProvider) {
  return localStorageServiceProvider.setPrefix('edt');
});

angular.module('edt-demo.edt').constant('BASE_API_URL', 'http://api-edt-ponts.securem.eu/');

angular.module('edt-demo.edt').config(function($stateProvider, $urlRouterProvider) {
  $stateProvider.state('edt', {
    url: '/?dep',
    controller: 'CourseListCtrl',
    templateUrl: 'edt/views/view.html'
  });
  return $urlRouterProvider.otherwise('/');
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uY29mZmVlIiwiZWR0L21vZHVsZS5jb2ZmZWUiLCJ1dGlscy9tb2R1bGUuY29mZmVlIiwiZWR0L2NvbnRyb2xsZXJzL2NvdXJzZV9saXN0LmNvZmZlZSIsImVkdC9jb250cm9sbGVycy9wYXJhbWV0ZXJzLmNvZmZlZSIsImVkdC9zZXJ2aWNlcy9jb3Vyc2VfZmFjdG9yeS5jb2ZmZWUiLCJlZHQvc2VydmljZXMvZGVwYXJ0bWVudF9saXN0X2V4dHJhY3Rvci5jb2ZmZWUiLCJ1dGlscy9jb25maWcvc3RvcmFnZS5jb2ZmZWUiLCJlZHQvY29uZmlnL2NvbmZpZy1sb2NhbHN0b3JhZ2UuY29mZmVlIiwiZWR0L2NvbmZpZy9jb25maWcuY29mZmVlIiwiZWR0L2NvbmZpZy9yb3V0ZXMuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7Ozs7Ozs7R0FBQTtBQUFBLFlBQUEsQ0FBQTtBQUFBLE9BV08sQ0FBQyxNQUFSLENBQWdCLFVBQWhCLEVBQTJCLENBQ3hCLFlBRHdCLEVBRXhCLG9CQUZ3QixFQUd4QixnQkFId0IsRUFJeEIsY0FKd0IsQ0FBM0IsQ0FYQSxDQUFBOztBQ0FBO0FBQUE7Ozs7Ozs7R0FBQTtBQUFBLE9BU08sQ0FBQyxNQUFSLENBQWdCLGNBQWhCLEVBQStCLENBQzVCLElBRDRCLEVBRTVCLFdBRjRCLENBQS9CLENBVEEsQ0FBQTs7QUNBQTtBQUFBOzs7Ozs7O0dBQUE7QUFBQSxPQVNPLENBQUMsTUFBUixDQUFnQixnQkFBaEIsRUFBaUMsQ0FDOUIsSUFEOEIsRUFFOUIsV0FGOEIsQ0FBakMsQ0FUQSxDQUFBOztBQ0FBLE9BQU8sQ0FBQyxNQUFSLENBQWdCLGNBQWhCLENBQ0EsQ0FBQyxVQURELENBQ2EsZ0JBRGIsRUFDOEIsU0FDNUIsTUFENEIsRUFFNUIsWUFGNEIsRUFHNUIsU0FINEIsRUFJNUIsYUFKNEIsRUFLNUIsdUJBTDRCLEVBTTVCLG1CQU40QixHQUFBO0FBUzVCLE1BQUEsNkJBQUE7QUFBQSxFQUFBLE1B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dWxlXG4gIEBuYW1lIGVkdC1kZW1vXG4gIEBtb2R1bGUgZWR0LWRlbW9cbiAgQGRlc2NyaXB0aW9uXG5cbiAgVGhpcyBtb2R1bGUgcmVxdWlyZXMgYWxsIHN1Ym1vZHVsZXMgb2YgeW91ciBhcHBcbiMjI1xuXG4ndXNlIHN0cmljdCdcblxuYW5ndWxhci5tb2R1bGUgJ2VkdC1kZW1vJywgW1xuICAnbmdNYXRlcmlhbCdcbiAgJ0xvY2FsU3RvcmFnZU1vZHVsZSdcbiAgJ2VkdC1kZW1vLnV0aWxzJ1xuICAnZWR0LWRlbW8uZWR0J1xuXVxuIiwiIyMjKlxuICBAbmdkb2MgbW9kdWxlXG4gIEBuYW1lIGVkdC1kZW1vLmxhbmRpbmdcbiAgQG1vZHVsZSBlZHQtZGVtby5sYW5kaW5nXG4gIEBkZXNjcmlwdGlvblxuXG4gIExhbmRpbmcgcGFnZSBvZiB0aGUgYXBwbGljYXRpb24uXG4jIyNcblxuYW5ndWxhci5tb2R1bGUgJ2VkdC1kZW1vLmVkdCcsIFtcbiAgJ25nJ1xuICAndWkucm91dGVyJ1xuXVxuIiwiIyMjKlxuICBAbmdkb2MgbW9kdWxlXG4gIEBuYW1lIGJvaWxlcnBsYXRlLnV0aWxzXG4gIEBtb2R1bGUgYm9pbGVycGxhdGUudXRpbHNcbiAgQGRlc2NyaXB0aW9uXG5cbiAgVGhpcyBtb2R1bGUgY29udGFpbnMgaGVscGVycyBhbmQgZ2xvYmFsIGNvbmZpZ3VyYXRpb24gcmVxdWlyZWQgYnkgeW91ciBhcHBcbiMjI1xuXG5hbmd1bGFyLm1vZHVsZSAnZWR0LWRlbW8udXRpbHMnLCBbXG4gICduZydcbiAgJ3VpLnJvdXRlcidcbl1cbiIsImFuZ3VsYXIubW9kdWxlICdlZHQtZGVtby5lZHQnXG4uY29udHJvbGxlciAnQ291cnNlTGlzdEN0cmwnLCAoXG4gICRzY29wZVxuICAkc3RhdGVQYXJhbXNcbiAgJG1kRGlhbG9nXG4gIENvdXJzZUZhY3RvcnlcbiAgRGVwYXJ0bWVudExpc3RFeHRyYWN0b3JcbiAgbG9jYWxTdG9yYWdlU2VydmljZVxuKSAtPlxuXG4gICRzY29wZS5jdXJyZW50RGVwYXJ0bWVudCA9IG51bGxcbiAgJHNjb3BlLmN1cnJlbnREYXRlID0gbmV3IERhdGUoKVxuICAkc2NvcGUuZXJyb3JOb05ldHdvcmsgPSBmYWxzZVxuXG4gIGFsZXJ0Tm9OZXR3b3JrID0gJG1kRGlhbG9nLmFsZXJ0KClcbiAgLnRpdGxlKCdFcnJldXIgcsOpc2VhdScpXG4gIC5jb250ZW50KCdJbXBvc3NpYmxlIGRlIHLDqWN1cMOpcmVyIGxhIGxpc3RlIGRlcyBjb3VycyAhJylcbiAgLmFyaWFMYWJlbCgnTmV0d29yayBlcnJvcicpXG4gIC5vaygnRG9tbWFnZSA6KCcpXG5cbiAgJHNjb3BlLmxvYWRDb3Vyc2VzID0gKCkgLT5cbiAgICBDb3Vyc2VGYWN0b3J5LmZpbmRBbGwoKVxuICAgIC5zdWNjZXNzIChkYXRhKSAtPlxuICAgICAgJHNjb3BlLmVycm9yTm9OZXR3b3JrID0gZmFsc2VcblxuICAgICAgJHNjb3BlLmNvdXJzZXMgPSBkYXRhXG4gICAgICBjb25zb2xlLmxvZyBcIkZvdW5kIFwiKyRzY29wZS5jb3Vyc2VzLmxlbmd0aCtcIiBjb3Vyc2VzXCJcblxuICAgICAgJHNjb3BlLmRlcGFydG1lbnRzID0gRGVwYXJ0bWVudExpc3RFeHRyYWN0b3IuZXh0cmFjdCAkc2NvcGUuY291cnNlc1xuICAgICAgY29uc29sZS5sb2cgXCJGb3VuZCBcIiskc2NvcGUuZGVwYXJ0bWVudHMubGVuZ3RoK1wiIGRlcGFydG1lbnRzXCJcblxuICAgICAgIyBTZXQgdGhlIHByZS1zZWxlY3RlZCBkZXBhcnRtZW50XG4gICAgICBzZXREZXBhcnRtZW50KClcblxuICAgIC5lcnJvciAoKSAtPlxuICAgICAgJG1kRGlhbG9nLnNob3coIGFsZXJ0Tm9OZXR3b3JrIClcbiAgICAgICRzY29wZS5lcnJvck5vTmV0d29yayA9IHRydWVcblxuICAkc2NvcGUuZGVwYXJ0bWVudEZpbHRlciA9IChjb3Vyc2UpIC0+XG4gICAgISRzY29wZS5jdXJyZW50RGVwYXJ0bWVudCBvciBjb3Vyc2UuZGVwYXJ0bWVudCA9PSAkc2NvcGUuY3VycmVudERlcGFydG1lbnRcblxuICAkc2NvcGUucGFzdENvdXJzZUZpbHRlciA9IChjb3Vyc2UpIC0+XG4gICAgISRzY29wZS5wcmVmcy5oaWRlUGFzdENvdXJzZXMgb3IgbmV3IERhdGUoRGF0ZS5wYXJzZShjb3Vyc2UudGltZV9lbmQpKSA+ICRzY29wZS5jdXJyZW50RGF0ZVxuXG4gICMgQ2FsbCB0aGUgQVBJXG4gICRzY29wZS5sb2FkQ291cnNlcygpXG5cbiAgc2V0RGVwYXJ0bWVudCA9ICgpIC0+XG4gICAgJHNjb3BlLmN1cnJlbnREZXBhcnRtZW50ID0gJHN0YXRlUGFyYW1zLmRlcCBvciBsb2NhbFN0b3JhZ2VTZXJ2aWNlLmdldCgnY3VycmVudERlcGFydG1lbnQnKSBvciBudWxsXG5cbiAgICAjIFdhdGNoIHRoZSBjdXJyZW50RGVwYXJ0bWVudCB0byBzdG9yZSBpdFxuICAgICRzY29wZS4kd2F0Y2ggJ2N1cnJlbnREZXBhcnRtZW50JywgICgpIC0+XG4gICAgICBsb2NhbFN0b3JhZ2VTZXJ2aWNlLnNldCAnY3VycmVudERlcGFydG1lbnQnLCAkc2NvcGUuY3VycmVudERlcGFydG1lbnRcbiAgICAsIHRydWVcbiIsImFuZ3VsYXIubW9kdWxlICdlZHQtZGVtby5lZHQnXG4uY29udHJvbGxlciAnUGFyYW1ldGVyc0N0cmwnLCAoXG4gICAgJHNjb3BlXG4gICAgJHN0YXRlUGFyYW1zXG4gICAgJG1kRGlhbG9nXG4gICAgJG1kU2lkZW5hdlxuICAgIGxvY2FsU3RvcmFnZVNlcnZpY2VcbiAgKSAtPlxuXG4gICMgSW5pdGlhbGl6ZSB0aGUgcHJlZmVyZW5jZXNcbiAgcHJlZnMgPSBsb2NhbFN0b3JhZ2VTZXJ2aWNlLmdldCgncHJlZnMnKVxuICBpZiBwcmVmc1xuICAgICRzY29wZS5wcmVmcyA9IHByZWZzXG4gIGVsc2VcbiAgICAkc2NvcGUucHJlZnMgPVxuICAgICAgaGlkZVBhc3RDb3Vyc2VzOiB0cnVlXG5cbiAgJHNjb3BlLiR3YXRjaCAncHJlZnMnLCAgKCkgLT5cbiAgICBsb2NhbFN0b3JhZ2VTZXJ2aWNlLnNldCAncHJlZnMnLCAkc2NvcGUucHJlZnNcbiAgLCB0cnVlXG5cbiAgJHNjb3BlLnRvZ2dsZVNpZGViYXIgPSAoKSAtPlxuICAgICRtZFNpZGVuYXYoJ2xlZnQnKS50b2dnbGUoKVxuIiwiYW5ndWxhci5tb2R1bGUgJ2VkdC1kZW1vLmVkdCdcbi5mYWN0b3J5ICdDb3Vyc2VGYWN0b3J5JywgKFxuICAkcm9vdFNjb3BlXG4gICRodHRwXG4gIEJBU0VfQVBJX1VSTFxuKSAtPlxuXG4gIGZpbmRBbGwgPSAoZGF0ZSA9IG51bGwpIC0+XG5cbiAgICBwYXJhbXMgPVxuICAgICAgZGF0ZTogZGF0ZSBvciBtb21lbnQoKS5mb3JtYXQgJ0REL01NL1lZWVknXG5cbiAgICAkaHR0cChcbiAgICAgIG1ldGhvZDogICAnR0VUJ1xuICAgICAgdXJsOiAgICAgICBCQVNFX0FQSV9VUkwrJ2NvdXJzZXMnXG4gICAgICBwYXJhbXM6ICAgIHBhcmFtc1xuICAgIClcbiAgICAuc3VjY2VzcyAoZGF0YSkgLT5cbiAgICAgIGRhdGFcblxuICBmaW5kQnlEZXBhcnRtZW50ID0gKGRlcGFydG1lbnRDb2RlLCBkYXRlID0gbnVsbCkgLT5cblxuICAgIHBhcmFtcyA9XG4gICAgICBkYXRlOiBkYXRlIG9yIG1vbWVudCgpLmZvcm1hdCAnREQvTU0vWVlZWSdcbiAgICAgIGRlcGFydG1lbnQ6IGRlcGFydG1lbnRDb2RlXG5cbiAgICAkaHR0cChcbiAgICAgIG1ldGhvZDogICAnR0VUJ1xuICAgICAgdXJsOiAgICAgICBCQVNFX0FQSV9VUkwrJ2NvdXJzZXMnXG4gICAgICBwYXJhbXM6ICAgIHBhcmFtc1xuICAgIClcbiAgICAuc3VjY2VzcyAoZGF0YSkgLT5cbiAgICAgIGRhdGFcblxuICBmaW5kQWxsOiBmaW5kQWxsXG4gIGZpbmRCeURlcGFydG1lbnQ6IGZpbmRCeURlcGFydG1lbnRcbiIsImFuZ3VsYXIubW9kdWxlICdlZHQtZGVtby5lZHQnXG4uc2VydmljZSAnRGVwYXJ0bWVudExpc3RFeHRyYWN0b3InLCAobG9jYWxTdG9yYWdlU2VydmljZSkgLT5cbiAgZXh0cmFjdCA9IChjb3Vyc2VzKSAtPlxuXG4gICAgIyBGaXJzdCwgY2hlY2sgaW4gdGhlIGxvY2FsU3RvcmFnZSBpZiB0aGUgbGlzdCBpcyBhbHJlYWR5IHByZXNlbnRcbiAgICBkZXBhcnRtZW50cyA9IGxvY2FsU3RvcmFnZVNlcnZpY2UuZ2V0KCdkZXBhcnRtZW50cycpXG5cbiAgICBpZiBub3QgZGVwYXJ0bWVudHNcbiAgICAgICMgV2UgbmVlZCB0byBleHRyYWN0IHRoZSBkZXBhcnRtZW50IGxpc3QgZnJvbSB0aGUgY291cnNlcyBsaXN0XG4gICAgICBjb25zb2xlLmxvZyAnRXh0cmFjdGluZyBkZXBhcnRtZW50cy4uLidcblxuICAgICAgZGVwYXJ0bWVudHMgPSBbXVxuICAgICAgZm9yIGNvdXJzZSBpbiBjb3Vyc2VzXG4gICAgICAgIGlmIGRlcGFydG1lbnRzLmluZGV4T2YoY291cnNlLmRlcGFydG1lbnQpIGlzIC0xXG4gICAgICAgICAgZGVwYXJ0bWVudHMucHVzaCBjb3Vyc2UuZGVwYXJ0bWVudFxuXG4gICAgICAjIFN0b3JlIHRoZSBsaXN0IGluIHRoZSBsb2NhbFN0b3JhZ2VcbiAgICAgIGxvY2FsU3RvcmFnZVNlcnZpY2Uuc2V0KCdkZXBhcnRtZW50cycsIGRlcGFydG1lbnRzKVxuXG4gICAgIyBSZXR1cm4gdGhlIGRlcGFydG1lbnRzIGxpc3RcbiAgICBkZXBhcnRtZW50c1xuXG4gIGV4dHJhY3Q6IGV4dHJhY3RcbiIsIiMjIypcbiAgQG5nZG9jIG9iamVjdFxuICBAbmFtZSBzdG9yYWdlXG4gIEBtb2R1bGUgZWR0LWRlbW8udXRpbHNcbiAgQGRlc2NyaXB0aW9uXG5cbiAgVGhpcyB2YWx1ZSBvYmplY3QgaXMgYW4gYXBwbGljYXRpb24td2lkZSBkYXRhLXN0b3JlLlxuICBJdCdzIHB1Ymxpc2hlZCBpbiBgJHJvb3RTY29wZWAgZm9yIGVhc3ktYWNjZXNzIGluIHZpZXdzLlxuIyMjXG5cbmFuZ3VsYXIubW9kdWxlICdlZHQtZGVtby51dGlscydcbi52YWx1ZSAnc3RvcmFnZScsIHt9XG5cbi5ydW4gKCRyb290U2NvcGUsIHN0b3JhZ2UpIC0+XG4gICRyb290U2NvcGUuc3RvcmFnZSA9IHN0b3JhZ2VcbiIsImFuZ3VsYXIubW9kdWxlICdlZHQtZGVtby5lZHQnXG4uY29uZmlnIChsb2NhbFN0b3JhZ2VTZXJ2aWNlUHJvdmlkZXIpIC0+XG4gIGxvY2FsU3RvcmFnZVNlcnZpY2VQcm92aWRlci5zZXRQcmVmaXgoJ2VkdCcpXG4iLCJhbmd1bGFyLm1vZHVsZSAnZWR0LWRlbW8uZWR0J1xuLmNvbnN0YW50ICdCQVNFX0FQSV9VUkwnLCAnaHR0cDovL2FwaS1lZHQtcG9udHMuc2VjdXJlbS5ldS8nIiwiYW5ndWxhci5tb2R1bGUgJ2VkdC1kZW1vLmVkdCdcbi5jb25maWcgKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIC0+XG4gICRzdGF0ZVByb3ZpZGVyXG4gIC5zdGF0ZSAnZWR0JyxcbiAgICB1cmw6ICcvP2RlcCdcbiAgICBjb250cm9sbGVyOiAgJ0NvdXJzZUxpc3RDdHJsJ1xuICAgIHRlbXBsYXRlVXJsOiAnZWR0L3ZpZXdzL3ZpZXcuaHRtbCdcblxuICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlICcvJ1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9